<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Quill Auto Blogger API</title>
    <style>
        :root {
            --bg: #0d1117;
            --sidebar: #161b22;
            --panel: #161b22;
            --line: #30363d;
            --text: #f0f6fc;
            --muted: #8b949e;
            --accent: #58a6ff;
            --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
            --sans: -apple-system, BlinkMacSystemFont, "Segoe UI", "Noto Sans", Helvetica, Arial, sans-serif;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0
        }

        body {
            font-family: var(--sans);
            background: var(--bg);
            color: var(--text);
            display: grid;
            grid-template-columns: 220px 1fr 420px;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            position: sticky;
            top: 0;
            height: 100vh;
            overflow: auto;
            background: var(--sidebar);
            border-right: 1px solid var(--line);
            padding: 20px 14px;
        }

        .brand {
            font-size: 15px;
            font-weight: 800;
            margin-bottom: 22px
        }

        .nav-title {
            font-size: 11px;
            color: var(--muted);
            text-transform: uppercase;
            letter-spacing: .12em;
            margin: 14px 8px 6px
        }

        .nav-link {
            display: block;
            padding: 8px 10px;
            border-radius: 8px;
            color: var(--text);
            text-decoration: none;
            font-size: 14px;
        }

        .nav-link:hover {
            background: #21262d
        }

        .nav-link.active {
            background: #58a6ff;
            color: #ffffff
        }

        .github-icon {
            margin-right: 8px;
            vertical-align: middle;
        }

        /* Main */
        .main {
            padding: 32px;
            overflow: auto;
            max-width: 100%;
            display: block
        }

        .main h1 {
            font-size: 28px;
            margin-bottom: 6px
        }

        .lead {
            color: var(--muted);
            margin-bottom: 28px
        }

        .endpoint {
            padding: 24px 0;
            border-top: 1px solid var(--line);
            width: 100%;
            display: block
        }

        .endpoint:first-of-type {
            border-top: none
        }

        .ep-head {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 6px
        }

        .method {
            font-size: 12px;
            font-weight: 800;
            padding: 4px 8px;
            border-radius: 6px;
            text-transform: uppercase
        }

        .GET {
            background: #0a8f08;
            color: #ffffff;
            border: 1px solid #0a8f08
        }

        .POST {
            background: #cf222e;
            color: #ffffff;
            border: 1px solid #cf222e
        }

        .path {
            font-family: var(--mono);
            font-size: 14px;
            background: #21262d;
            border: 1px solid #30363d;
            padding: 3px 8px;
            border-radius: 6px
        }

        .desc {
            color: var(--muted);
            font-size: 14px;
            margin-bottom: 12px
        }

        .notes {
            background: #21262d;
            border: 1px solid #30363d;
            border-radius: 6px;
            padding: 12px;
            margin: 12px 0;
            color: #8b949e;
            font-size: 13px;
            font-style: italic
        }

        .subttl {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: .14em;
            color: var(--muted);
            margin-top: 14px
        }

        .kv {
            margin-top: 8px;
            width: 100%;
            display: block
        }

        .kv dt {
            font-size: 13px;
            color: #f0f6fc
        }

        .kv dd {
            font-family: var(--mono);
            font-size: 13px;
            background: #21262d;
            border: 1px solid #30363d;
            border-radius: 6px;
            padding: 6px 8px;
            margin: 6px 0 10px;
            color: #f0f6fc
        }

        /* Right code panel */
        .panel {
            position: sticky;
            top: 0;
            height: 100vh;
            overflow: auto;
            background: var(--panel);
            border-left: 1px solid var(--line);
            padding: 22px 18px;
        }

        .label {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: .14em;
            color: var(--muted);
            margin: 4px 0 8px
        }

        .code {
            position: relative;
            background: #21262d;
            border: 1px solid #30363d;
            border-radius: 6px;
            padding: 12px;
            font-family: var(--mono);
            font-size: 13px;
            white-space: pre-wrap;
            word-wrap: break-word;
            overflow-x: auto;
            color: #f0f6fc;
            max-width: 100%;
        }

        .code::-webkit-scrollbar {
            height: 8px;
        }

        .code::-webkit-scrollbar-track {
            background: #161b22;
            border-radius: 4px;
        }

        .code::-webkit-scrollbar-thumb {
            background: #484f58;
            border-radius: 4px;
        }

        .code::-webkit-scrollbar-thumb:hover {
            background: #5a6169;
        }

        .copy {
            position: absolute;
            top: 8px;
            right: 8px;
            font-size: 12px;
            padding: 6px 8px;
            border-radius: 6px;
            border: 1px solid #30363d;
            background: #0d1117;
            color: #8b949e;
            cursor: pointer
        }

        /* Responsive */
        @media (max-width: 1200px) {
            body {
                grid-template-columns: 220px 1fr
            }

            .panel {
                display: none
            }
        }

        @media (max-width: 700px) {
            body {
                grid-template-columns: 1fr
            }

            .sidebar {
                display: none
            }

            .main {
                padding: 22px 16px
            }
        }

        /* Code block improvements */
        .code {
            position: relative;
            background: #21262d;
            border: 1px solid #30363d;
            border-radius: 6px;
            padding: 12px;
            font-family: var(--mono);
            font-size: 13px;
            white-space: pre-wrap;
            word-wrap: break-word;
            overflow-x: auto;
            color: #f0f6fc;
            max-width: 100%;
        }

        .code::-webkit-scrollbar {
            height: 8px;
        }

        .code::-webkit-scrollbar-track {
            background: #161b22;
            border-radius: 4px;
        }

        .code::-webkit-scrollbar-thumb {
            background: #484f58;
            border-radius: 4px;
        }

        .code::-webkit-scrollbar-thumb:hover {
            background: #5a6169;
        }

        /* Better mobile layout */
        @media (max-width: 768px) {
            .main {
                padding: 20px 16px;
            }

            .endpoint {
                padding: 20px 0;
            }

            .ep-head {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }

            .method {
                align-self: flex-start;
            }

            .path {
                font-size: 13px;
                word-break: break-all;
            }

            .kv dd {
                word-break: break-all;
                font-size: 12px;
            }
        }

        @media (max-width: 480px) {
            .main {
                padding: 16px 12px;
            }

            .main h1 {
                font-size: 24px;
            }

            .lead {
                font-size: 14px;
            }

            .endpoint {
                padding: 16px 0;
            }
        }

        @media (max-width: 480px) {
            .main {
                padding: 16px 12px;
            }

            .main h1 {
                font-size: 24px;
            }

            .lead {
                font-size: 14px;
            }

            .endpoint {
                padding: 16px 0;
            }
        }

        a {
            color: #58a6ff
        }
    </style>
</head>

<body>
    <!-- LEFT SIDEBAR -->
    <aside class="sidebar">
        <div class="brand">
            <img src="https://www.paulchrisluke.com/pcl-labs-logo.svg" alt="PCL Labs"
                style="width: 100%; max-width: 180px; height: auto; margin-bottom: 8px;">
            <div style="font-size: 12px; color: var(--muted); text-align: center; font-style: italic;">made with ❤️ open
                source</div>
        </div>
        <div class="nav-title">Blog</div>
        <a class="nav-link active" href="#ep-blog">/blog/{date}</a>
        <a class="nav-link" href="#ep-assets">/assets/*</a>

        <div class="nav-title">Control</div>
        <a class="nav-link" href="#ep-start">/control/record/start</a>

        <div class="nav-title">Links</div>
        <a class="nav-link github-link" href="https://github.com/paulchrisluke/quill-auto-blogger" target="_blank">
            <svg class="github-icon" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path
                    d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z" />
            </svg>
            View on GitHub
        </a>
    </aside>

    <!-- MAIN CONTENT (simple one column) -->
    <main class="main" id="content">
        <h1>API Reference</h1>
        <p class="lead">Pure JSON API for AI-enhanced blog content. The Worker serves FINAL digest data with AI
            enhancements, structured SEO metadata, and complete story packets.</p>

        <div class="notes">
            <strong>Pipeline Structure:</strong> The system generates PRE-CLEANED (raw) and FINAL (AI-enhanced) digest
            versions.
            The API serves the FINAL version with AI-generated content including SEO descriptions, holistic intros,
            wrap-ups, and story intros.
        </div>

        <!-- GET /blog/{date} -->
        <section id="ep-blog" class="endpoint"
            data-curl='curl "https://quill-blog-api.paulchrisluke.workers.dev/blog/2025-08-29"' data-json='{
  "version": "2",
  "date": "2025-08-29",
  "frontmatter": {
    "title": "Daily Devlog — Aug 29, 2025",
    "description": "AI-enhanced description...",
    "holistic_intro": "AI-generated holistic introduction...",
    "wrap_up": "AI-generated wrap-up...",
    "schema": {
      "article": {
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": "Daily Devlog — Aug 29, 2025"
      }
    }
  },
  "story_packets": [
    {
      "id": "story_20250829_pr43",
      "title_human": "Shipped: Feature Name",
      "ai_micro_intro": "AI-generated micro introduction...",
      "ai_comprehensive_intro": "AI-generated comprehensive introduction...",
      "video": {
        "thumbnail_url": "https://quill-blog-api.paulchrisluke.workers.dev/assets/stories/2025/08/29/story_20250829_pr43_01_intro.png"
      }
    }
  ]
}'>
            <div class="ep-head"><span class="method GET">GET</span><span class="path">/blog/{date}</span></div>
            <p class="desc">Retrieve complete AI-enhanced blog data including frontmatter, story packets, and structured
                SEO metadata.</p>
            <div class="notes">Returns FINAL digest data with AI enhancements, JSON-LD schema, and complete story
                packets.</div>
            <div class="subttl">Path Parameters</div>
            <dl class="kv">
                <dt>date</dt>
                <dd>string (YYYY-MM-DD)</dd>
            </dl>
            <div class="subttl">Example</div>
            <dl class="kv">
                <dd>/api/blog/2025-08-29</dd>
            </dl>
        </section>



        <!-- GET /assets/* -->
        <section id="ep-assets" class="endpoint"
            data-curl='curl "https://quill-blog-api.paulchrisluke.workers.dev/assets/stories/2025/08/29/story_20250829_pr43_01_intro.png"'
            data-json='Direct asset serving from R2 bucket'>
            <div class="ep-head"><span class="method GET">GET</span><span class="path">/assets/*</span>
            </div>
            <p class="desc">Serve static assets (images, videos, highlights) directly from R2 bucket.</p>
            <div class="notes">Assets are served with proper content-type headers and caching.</div>
            <div class="subttl">Example Paths</div>
            <dl class="kv">
                <dt>Story thumbnails</dt>
                <dd>/assets/stories/2025/08/29/story_20250829_pr43_01_intro.png</dd>
                <dt>Video files</dt>
                <dd>/assets/stories/2025/08/29/story_20250829_pr43.mp4</dd>
            </dl>
        </section>

        <!-- POST /control/record/start -->
        <section id="ep-start" class="endpoint" data-curl='curl -X POST "https://quill-blog-api.paulchrisluke.workers.dev/control/record/start" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d ' \''{"story_id":"test_story","bounded":false}'\'' ' data-json=' { "status" : "started" , "mode" : "bounded"
            , "story_id" : "test_story" , "prep_delay" : 5, "duration" : 15 }'>
            <div class="ep-head"><span class="method POST">POST</span><span class="path">/control/record/start</span>
            </div>
            <p class="desc">Start recording for a story (requires token). Supports optional <code
                    style="font-family:var(--mono)">bounded</code> mode.</p>
            <div class="subttl">Headers</div>
            <dl class="kv">
                <dt>Authorization</dt>
                <dd>Bearer &lt;CONTROL_API_TOKEN&gt;</dd>
            </dl>
            <div class="subttl">Request Body</div>
            <dl class="kv">
                <dt>story_id</dt>
                <dd>string</dd>
                <dt>date</dt>
                <dd>string (YYYY-MM-DD, optional)</dd>
                <dt>bounded</dt>
                <dd>boolean (default: false)</dd>
            </dl>
        </section>
    </main>

    <!-- RIGHT CODE PANEL -->
    <aside class="panel">
        <div class="label">cURL</div>
        <div class="code" id="code-curl"><button class="copy">Copy</button>
            curl "https://quill-blog-api.paulchrisluke.workers.dev/blog/2025-08-29"
        </div>
        <div class="label">200 Example</div>
        <div class="code" id="code-json"><button class="copy">Copy</button>
            {
            "version": "2",
            "date": "2025-08-29",
            "frontmatter": {
            "title": "Daily Devlog — Aug 29, 2025",
            "description": "AI-enhanced description...",
            "holistic_intro": "AI-generated holistic introduction...",
            "wrap_up": "AI-generated wrap-up..."
            },
            "story_packets": [...]
            }
        </div>
    </aside>

    <script>
        // Map endpoint sections to sidebar and set initial example
        const sections = [...document.querySelectorAll('.endpoint')];
        const sidebarLinks = [...document.querySelectorAll('.nav-link')];
        const curlEl = document.getElementById('code-curl');
        const jsonEl = document.getElementById('code-json');

        function setExamplesFrom(el) {
            const curl = el.getAttribute('data-curl') || '';
            const json = el.getAttribute('data-json') || '';
            setBlock(curlEl, curl);
            setBlock(jsonEl, json);
            // highlight active link
            const id = '#' + el.id;
            sidebarLinks.forEach(a => a.classList.toggle('active', a.getAttribute('href') === id));
        }

        function setBlock(blockEl, text) {
            // replace only the text node (keep the copy button)
            const btn = blockEl.querySelector('.copy');
            blockEl.textContent = '\n' + text;
            if (btn) { blockEl.prepend(btn); }
        }

        // Click in sidebar updates examples
        sidebarLinks.forEach(a => {
            a.addEventListener('click', (e) => {
                const id = a.getAttribute('href').slice(1);
                const target = document.getElementById(id);
                if (target) {
                    e.preventDefault();
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    setExamplesFrom(target);
                }
            });
        });

        // Scroll spy: when you scroll, update examples to nearest section
        const spy = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    setExamplesFrom(entry.target);
                }
            });
        }, { root: document.querySelector('.main'), threshold: 0.4 });

        sections.forEach(s => spy.observe(s));
        setExamplesFrom(document.getElementById('ep-blog')); // initial

        // Copy buttons
        document.querySelectorAll('.code .copy').forEach(btn => {
            btn.addEventListener('click', () => {
                const parent = btn.parentElement;
                const text = parent.textContent.replace('Copy', '').trim();
                navigator.clipboard.writeText(text);
                const old = btn.textContent; btn.textContent = 'Copied!';
                setTimeout(() => btn.textContent = old, 1200);
            });
        });
    </script>
</body>

</html>